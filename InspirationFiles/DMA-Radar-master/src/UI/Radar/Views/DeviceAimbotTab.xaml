<UserControl x:Class="LoneEftDmaRadar.UI.Radar.Views.DeviceAimbotTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:LoneEftDmaRadar.UI.Radar.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:converters="clr-namespace:LoneEftDmaRadar.UI.Converters"
             xmlns:conv="clr-namespace:LoneEftDmaRadar.UI.Misc"
             xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
             mc:Ignorable="d"
             Padding="10">
    <UserControl.Resources>
        <converters:InverseBooleanConverter x:Key="InverseBooleanConverter" />
        <conv:StringToColorConverter x:Key="StringToColorConverter" />
    </UserControl.Resources>

    <d:UserControl.DataContext>
        <d:DesignInstance Type="{x:Type vm:DeviceAimbotViewModel}" IsDesignTimeCreatable="False" />
    </d:UserControl.DataContext>
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <UniformGrid Columns="2" Rows="0" Margin="0,0,0,10" HorizontalAlignment="Stretch">
            <!-- Device Connection -->
            <GroupBox Header="Device Connection" Margin="0,0,12,12">
                <StackPanel>
                    <TextBlock Text="Status:" FontWeight="Bold" Margin="8,8,8,4" />
                    <StackPanel Orientation="Horizontal" Margin="8,0,8,8">
                        <Ellipse Width="12" Height="12" VerticalAlignment="Center" Margin="0,0,8,0">
                            <Ellipse.Style>
                                <Style TargetType="Ellipse">
                                    <Setter Property="Fill" Value="#FFFF4444" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsConnected}" Value="True">
                                            <Setter Property="Fill" Value="#FF44FF44" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Ellipse.Style>
                        </Ellipse>
                        <TextBlock Text="{Binding ConnectionStatus}" VerticalAlignment="Center" />
                    </StackPanel>

                    <TextBlock Text="Device Version:" FontWeight="Bold" Margin="8,8,8,4" />
                    <TextBlock Text="{Binding DeviceVersion}" Margin="8,0,8,8" />
                    
                    <CheckBox Content="Use KMBox NET"
                              IsChecked="{Binding UseKmBoxNet, Mode=TwoWay}"
                              Margin="8,4,8,8" />

                    <StackPanel Margin="8,0,8,8" IsEnabled="{Binding UseKmBoxNet}">
                        <TextBlock Text="KMBox NET IP / Port / MAC" FontWeight="Bold" />
                        <StackPanel Orientation="Horizontal" Margin="0,4,0,4">
                            <TextBox Text="{Binding KmBoxNetIp, Mode=TwoWay}" Width="140" Margin="0,0,8,0"/>
                            <TextBox Text="{Binding KmBoxNetPort, Mode=TwoWay}" Width="80" Margin="0,0,8,0"/>
                            <TextBox Text="{Binding KmBoxNetMac, Mode=TwoWay}" Width="120"/>
                        </StackPanel>
                    </StackPanel>

                    <CheckBox Content="Auto-connect on startup"
                              IsChecked="{Binding AutoConnect, Mode=TwoWay}"
                              Margin="8,4,8,8" />
                    
                    <TextBlock Text="Available Devices:" FontWeight="Bold" Margin="8,8,8,4" />
                    <ComboBox ItemsSource="{Binding AvailableDevices}"
                              SelectedItem="{Binding SelectedDevice, Mode=TwoWay}"
                              Margin="8,4,8,8"
                              MinHeight="30">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Port}" FontWeight="Bold" Margin="0,0,8,0"/>
                                    <TextBlock Text="-" Margin="0,0,8,0" Foreground="Gray"/>
                                    <TextBlock Text="{Binding Description}" Foreground="DarkGray"/>
                                </StackPanel>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                    
                    <WrapPanel Margin="0,8,0,8">
                        <Button Content="Refresh Devices"
                                Command="{Binding RefreshDevicesCommand}"
                                MinWidth="120"
                                Height="35"
                                Margin="8,0,8,0"
                                IsEnabled="{Binding IsConnected, Converter={StaticResource InverseBooleanConverter}}" />

                        <Button Content="Connect"
                                Command="{Binding ConnectCommand}"
                                MinWidth="120"
                                Height="35"
                                Margin="8,0,8,0"
                                IsEnabled="{Binding IsConnected, Converter={StaticResource InverseBooleanConverter}}" />

                        <Button Content="Disconnect"
                                Command="{Binding DisconnectCommand}"
                                MinWidth="120"
                                Height="35"
                                Margin="8,0,8,0"
                                IsEnabled="{Binding IsConnected}" />
                    </WrapPanel>
                    
                    <Button Content="? Test Mouse Movement" 
                            Command="{Binding TestMoveCommand}" 
                            Padding="15,8" 
                            Background="#FF1E1E1E"
                            BorderBrush="#FF3A3A3A"
                            Foreground="#FFE6E6E6"
                            ToolTip="Moves the mouse in a test pattern to verify the device is working"
                            IsEnabled="{Binding IsConnected}"/>
                    <TextBlock Text="? (Device must be connected)" 
                               VerticalAlignment="Center" 
                               Foreground="Gray" 
                               FontSize="11" 
                               Margin="10,5,0,0"/>
                </StackPanel>
            </GroupBox>

            <!-- Aimbot Settings -->
            <GroupBox Header="Aimbot Settings" Margin="0,0,0,12">
                <StackPanel>
                    <CheckBox Content="Enable DeviceAimbot Aimbot"
                              IsChecked="{Binding Enabled, Mode=TwoWay}"
                              FontWeight="Bold"
                              Margin="8,8,8,8" />
                    
                    <TextBlock Text="Target Bone" FontWeight="Bold" Margin="8,8,8,4" />
                    <ComboBox ItemsSource="{Binding AvailableBones}"
                              SelectedItem="{Binding TargetBone, Mode=TwoWay}"
                              Margin="8,4,8,8" />
                    
                    <TextBlock Text="Targeting Mode" FontWeight="Bold" Margin="8,8,8,4" />
                    <ComboBox SelectedIndex="{Binding TargetingMode, Mode=TwoWay}"
                              Margin="8,4,8,8">
                        <ComboBoxItem Content="Closest to Crosshair (FOV)" />
                        <ComboBoxItem Content="Closest Distance" />
                    </ComboBox>

                    <TextBlock Text="{Binding Smoothing, StringFormat='Smoothing: {0:F1}x'}" 
                               FontWeight="Bold"
                               Margin="8,8,8,4" />
                    <Slider Value="{Binding Smoothing, Mode=TwoWay}"
                            Minimum="1"
                            Maximum="8"
                            TickFrequency="0.5"
                            IsSnapToTickEnabled="True"
                            Margin="8,4,8,8" />
                    
                    <TextBlock Text="{Binding FOV, StringFormat='FOV: {0:F0}'}" 
                               FontWeight="Bold"
                               Margin="8,8,8,4" />
                    <Slider Value="{Binding FOV, Mode=TwoWay}"
                            Minimum="10"
                            Maximum="500"
                            TickFrequency="10"
                            IsSnapToTickEnabled="True"
                            Margin="8,4,8,8" />
                    
                    <TextBlock Text="{Binding MaxDistance, StringFormat='Max Distance: {0:F0}m'}" 
                               FontWeight="Bold"
                               Margin="8,8,8,4" />
                    <Slider Value="{Binding MaxDistance, Mode=TwoWay}"
                            Minimum="50"
                            Maximum="500"
                            TickFrequency="50"
                            IsSnapToTickEnabled="True"
                            Margin="8,4,8,8" />
                    
                    <CheckBox Content="Enable Bullet Drop Prediction"
                              IsChecked="{Binding EnablePrediction, Mode=TwoWay}"
                              Margin="8,4,8,8" />

                    <Separator Margin="8,12,8,12" />

                    <CheckBox Content="Show FOV Circle on ESP"
                              IsChecked="{Binding ShowFovCircle, Mode=TwoWay}"
                              FontWeight="Bold"
                              Margin="8,4,8,8" />

                    <WrapPanel Margin="8,4,8,4">
                        <TextBlock Text="FOV Circle Color (Engaged):"
                                   VerticalAlignment="Center"
                                   Margin="0,0,8,0"
                                   Width="180" />
                        <xctk:ColorPicker Width="60" Height="26"
                                          SelectedColor="{Binding FovCircleColorEngaged, Mode=TwoWay, Converter={StaticResource StringToColorConverter}}"
                                          UsingAlphaChannel="True"
                                          ShowRecentColors="False"
                                          ToolTip="Color when aimbot is actively engaged" />
                    </WrapPanel>

                    <WrapPanel Margin="8,4,8,8">
                        <TextBlock Text="FOV Circle Color (Idle):"
                                   VerticalAlignment="Center"
                                   Margin="0,0,8,0"
                                   Width="180" />
                        <xctk:ColorPicker Width="60" Height="26"
                                          SelectedColor="{Binding FovCircleColorIdle, Mode=TwoWay, Converter={StaticResource StringToColorConverter}}"
                                          UsingAlphaChannel="True"
                                          ShowRecentColors="False"
                                          ToolTip="Color when aimbot is not engaged" />
                    </WrapPanel>
                </StackPanel>
            </GroupBox>

            <!-- Target Filters -->
            <GroupBox Header="Target Filters" Margin="0,0,12,12">
                <StackPanel>
                    <TextBlock Text="Select which player types to target" 
                               TextWrapping="Wrap"
                               Margin="8,8,8,8"
                               Foreground="Gray" />
                    
                    <CheckBox Content="Target PMC Players"
                              IsChecked="{Binding TargetPMC, Mode=TwoWay}"
                              Margin="8,4,8,4" />
                    
                    <CheckBox Content="Target Player Scavs"
                              IsChecked="{Binding TargetPlayerScav, Mode=TwoWay}"
                              Margin="8,4,8,4" />
                    
                    <CheckBox Content="Target AI Scavs"
                              IsChecked="{Binding TargetAIScav, Mode=TwoWay}"
                              Margin="8,4,8,4" />
                    
                    <CheckBox Content="Target Bosses"
                              IsChecked="{Binding TargetBoss, Mode=TwoWay}"
                              Margin="8,4,8,4" />

                    <CheckBox Content="Target Raiders"
                              IsChecked="{Binding TargetRaider, Mode=TwoWay}"
                              Margin="8,4,8,4" />
                </StackPanel>
            </GroupBox>

            <!-- Help Text -->
            <GroupBox Header="Usage" Margin="0,0,0,12">
                <TextBlock TextWrapping="Wrap" 
                           Margin="8,8,8,8">
                    1. Connect your DeviceAimbot device using the dropdown above<LineBreak />
                    2. Enable the aimbot with the checkbox<LineBreak />
                    3. Hold a configured mouse button (set it in Settings â†’ Hotkeys tab) to activate<LineBreak />
                    4. The aimbot will automatically target enemies within FOV<LineBreak />
                    <LineBreak />
                    Note: You can enable Silentaimbot (Uses Memory Write) in MemWrites tab, it will use the same hotkey and all settings from here. Silent Aim Does not aim for you, it tells bullets where to go your gun won't move to the target bone, your bullets will.<LineBreak />
                    <LineBreak />
                    Make sure your DeviceAimbot firmware is up to date.
                </TextBlock>
            </GroupBox>
        </UniformGrid>
    </ScrollViewer>
</UserControl>
